{"version":3,"file":"js/app.d3b0925e.js","mappings":"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","sources":["webpack://dapp-libp2p/./src/App.vue","webpack://dapp-libp2p/./src/utils/ha.js","webpack://dapp-libp2p/./src/utils/libp2p.js","webpack://dapp-libp2p/./src/utils/hook.js","webpack://dapp-libp2p/./src/App.vue?7ccd","webpack://dapp-libp2p/./src/main.js","webpack://dapp-libp2p/webpack/bootstrap","webpack://dapp-libp2p/webpack/runtime/chunk loaded","webpack://dapp-libp2p/webpack/runtime/compat get default export","webpack://dapp-libp2p/webpack/runtime/define property getters","webpack://dapp-libp2p/webpack/runtime/global","webpack://dapp-libp2p/webpack/runtime/hasOwnProperty shorthand","webpack://dapp-libp2p/webpack/runtime/make namespace object","webpack://dapp-libp2p/webpack/runtime/jsonp chunk loading","webpack://dapp-libp2p/webpack/startup"],"sourcesContent":["<template>\n  <div>\n    <div v-if=\"peerId\">\n      <h2 v-if=\"peerId\">peerId: {{ peerId }}</h2>\n      <br />\n      <br />\n      <div>\n        <input v-model=\"multiaddress\" type=\"text\" />\n        <br />\n        <button @click=\"connectClick\">connect</button>\n      </div>\n      <br />\n      <br />\n\n      <div v-if=\"connections.length > 1\" style=\"width: 800px; margin: 0 auto\">\n        <h4>Connections</h4>\n        <ul style=\"text-align: left\">\n          <li\n            v-for=\"(connection, k) in connections\"\n            :key=\"k\"\n            style=\"margin: 10px\"\n          >\n            {{ connection }}\n          </li>\n        </ul>\n      </div>\n\n      <div v-if=\"connectionPeerId\">\n        control: {{ connectionPeerId }}\n        <br />\n        <br />\n        <button @click=\"launchClick\">{{ stateLamp }}</button>\n        <pre\n          v-if=\"data\"\n          style=\"\n            text-align: left;\n            width: 400px;\n            margin: 0 auto;\n            border: 1px solid #eee;\n            padding: 10px;\n          \"\n          >{{ data }}</pre\n        >\n      </div>\n    </div>\n    <button v-else @click=\"startClick\">start node</button>\n\n    <div>{{ error }}</div>\n  </div>\n</template>\n\n<script>\nimport { useData } from \"@/utils/hook\";\nimport { computed, ref } from \"vue\";\n\nexport default {\n  setup() {\n    const connections = ref([]);\n    const error = ref();\n    const multiaddress = ref();\n\n    const {\n      data,\n      connectionPeerId,\n      updateTime,\n      run,\n      launch,\n      connectPeer,\n      peerId\n    } = useData();\n\n    const startClick = async () => {\n      await run(conns => {\n        connections.value = conns;\n      });\n    };\n\n    const connectClick = async () => {\n      const conn = await connectPeer(multiaddress.value);\n      if (conn) {\n        select(conn.remoteAddr.toString());\n        multiaddress.value = \"\";\n      }\n    };\n\n    const stateLamp = computed(() => {\n      let state = \"on\";\n      if (data.value && data.value.data.lamp.state === \"on\") {\n        state = \"off\";\n      }\n      return state;\n    });\n\n    const launchClick = async () => {\n      error.value = undefined;\n      if (!connectionPeerId.value) {\n        return;\n      }\n      let state = \"on\";\n      if (data.value && data.value.data.lamp.state === \"on\") {\n        state = \"off\";\n      }\n      try {\n        await launch(connectionPeerId.value, {\n          device: \"lamp\",\n          state: state\n        });\n      } catch (e) {\n        error.value = e.message;\n      }\n    };\n\n    const select = conn => {\n      connectionPeerId.value = conn;\n      data.value = null;\n      error.value = undefined;\n    };\n\n    return {\n      multiaddress,\n      data,\n      updateTime,\n      startClick,\n      connectClick,\n      launchClick,\n      peerId,\n      connectionPeerId,\n      stateLamp,\n      connections,\n      select,\n      error\n    };\n  }\n};\n</script>\n\n<style>\n#app {\n  font-family: Avenir, Helvetica, Arial, sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  text-align: center;\n  color: #2c3e50;\n  margin-top: 60px;\n}\n</style>\n","import { pipe } from \"it-pipe\";\nimport { fromString as uint8ArrayFromString } from \"uint8arrays/from-string\";\nimport { toString as uint8ArrayToString } from \"uint8arrays/to-string\";\n\nexport function createHa() {\n  return components => {\n    async function getRequest(stream) {\n      return pipe(stream, async function (source) {\n        let result = \"\";\n        for await (const data of source) {\n          result += uint8ArrayToString(data.subarray());\n        }\n        try {\n          return JSON.parse(result);\n        } catch (error) {\n          console.log(error);\n        }\n        return;\n      });\n    }\n\n    async function sendResponse(stream, msg) {\n      return pipe(\n        [uint8ArrayFromString(JSON.stringify(msg))],\n        stream.sink\n      ).finally(() => {\n        stream.close();\n      });\n    }\n\n    return {\n      async handle(\n        protocol,\n        handler,\n        options = {\n          runOnTransientConnection: true\n        }\n      ) {\n        await components.registrar.handle(\n          protocol,\n          async ({ stream, connection }) => {\n            handler(await getRequest(stream), stream, connection);\n          },\n          options\n        );\n      },\n      async request(\n        connection,\n        protocol,\n        data,\n        options = {\n          runOnTransientConnection: true\n        }\n      ) {\n        if (connection.status !== \"open\") {\n          return;\n        }\n        const stream = await connection.newStream([protocol], options);\n        return pipe(\n          [uint8ArrayFromString(JSON.stringify(data))],\n          stream,\n          async function (source) {\n            let result = \"\";\n            for await (const data of source) {\n              result += uint8ArrayToString(data.subarray());\n            }\n            try {\n              // stream.close();\n              return JSON.parse(result);\n            } catch (error) {\n              return result;\n            }\n          }\n        );\n      },\n      utils: {\n        getRequest,\n        sendResponse\n      }\n    };\n  };\n}\n","import { noise } from \"@chainsafe/libp2p-noise\";\nimport { circuitRelayTransport } from \"@libp2p/circuit-relay-v2\";\nimport { identify } from \"@libp2p/identify\";\nimport { mplex } from \"@libp2p/mplex\";\nimport { webSockets } from \"@libp2p/websockets\";\nimport * as filters from \"@libp2p/websockets/filters\";\nimport { multiaddr } from \"@multiformats/multiaddr\";\nimport { createLibp2p } from \"libp2p\";\nimport { createHa } from \"./ha\";\n\nexport async function createNode() {\n  const node = await createLibp2p({\n    transports: [\n      webSockets({\n        filter: filters.all\n      }),\n      circuitRelayTransport()\n    ],\n    streamMuxers: [mplex()],\n    connectionEncryption: [noise()],\n    services: {\n      identify: identify(),\n      ha: createHa()\n    },\n    connectionGater: {\n      denyDialMultiaddr: () => {\n        return false;\n      }\n    },\n    connectionManager: {\n      minConnections: 0\n    }\n  });\n  return node;\n}\n\nexport function pingWs(uri) {\n  return new Promise((res, rej) => {\n    const timeoutId = setTimeout(() => {\n      rej(new Error(\"timeout\"));\n    }, 10000);\n    const ws = new WebSocket(uri);\n    ws.addEventListener(\"error\", () => {\n      clearTimeout(timeoutId);\n      rej(new Error(\"connect\"));\n    });\n    ws.addEventListener(\"open\", () => {\n      ws.close();\n      clearTimeout(timeoutId);\n      res();\n    });\n  });\n}\n\nexport async function checkMultiaddr(multiaddress) {\n  let protocol = \"ws\";\n  if (location.protocol === \"https:\") {\n    protocol = \"wss\";\n  }\n\n  const localMultiaddr = multiaddr(multiaddress);\n  const protoNames = localMultiaddr.protoNames();\n\n  const check = () => {\n    if (protocol === \"wss\") {\n      return protoNames.includes(\"wss\");\n    }\n    return protoNames.includes(\"ws\") || protoNames.includes(\"wss\");\n  };\n\n  if (check()) {\n    if (protoNames.includes(\"p2p-circuit\")) {\n      return localMultiaddr;\n    } else {\n      const address = localMultiaddr.nodeAddress();\n      try {\n        await pingWs(\n          `${protoNames.includes(\"wss\") ? \"wss\" : \"ws\"}://${address.address}:${\n            address.port\n          }`\n        );\n        return localMultiaddr;\n      } catch (error) {\n        console.log(error);\n      }\n    }\n  }\n\n  return false;\n}\n\nlet node = null;\n\nexport async function start(cb) {\n  if (node) {\n    return node;\n  }\n  node = await createNode();\n  await node.start();\n  console.log(`Node started with id ${node.peerId.toString()}`);\n\n  async function updateConnectionsList() {\n    const connections = node.getConnections().map(item => {\n      return item.remoteAddr.toString();\n    });\n    console.log(\"Update Connections List\", connections);\n    cb(connections);\n  }\n\n  node.addEventListener(\"connection:open\", event => {\n    console.log(\"connected\", event.detail.remoteAddr.toString());\n    updateConnectionsList();\n  });\n\n  node.addEventListener(\"connection:close\", event => {\n    console.log(\"disconected\", event.detail.remoteAddr.toString());\n    updateConnectionsList();\n  });\n\n  node.addEventListener(\"peer:discovery\", evt => {\n    console.log(\"Discovered:\", evt.detail.id.toString());\n  });\n\n  return node;\n}\n\nexport async function connect(addr) {\n  if (!node) {\n    return false;\n  }\n  const connection = node.getConnections().find(item => {\n    return item.remoteAddr.toString() === addr;\n  });\n  if (connection) {\n    return connection;\n  }\n  try {\n    const listenerMultiaddr = multiaddr(addr);\n    return await node.dial(listenerMultiaddr);\n  } catch (error) {\n    console.log(error);\n  }\n  return false;\n}\n\nexport function request(peerId, data) {\n  const connection = node.getConnections().find(item => {\n    return item.remotePeer.toString() === peerId;\n  });\n  if (node && connection) {\n    return node.services.ha.request(connection, \"/call\", data);\n  }\n  throw new Error(\"error\");\n}\n","import { ref } from \"vue\";\nimport { checkMultiaddr, connect, request, start } from \"./libp2p\";\n\nexport const useData = () => {\n  const data = ref(null);\n  const updateTime = ref(null);\n  const peerId = ref(null);\n  const connectionPeerId = ref(null);\n\n  const run = async cb => {\n    const node = await start(cb);\n    peerId.value = node.peerId.toString();\n    listen(node);\n    return true;\n  };\n\n  const listen = async node => {\n    try {\n      const protocols = node.getProtocols();\n      if (protocols.includes(\"/update\")) {\n        await node.unhandle(\"/update\");\n      }\n      node.services.ha.handle(\n        \"/update\",\n        async (dataRaw, stream, fromConnection) => {\n          console.log(\"from\", fromConnection.remotePeer.toString());\n          console.log(connectionPeerId.value);\n          if (connectionPeerId.value === fromConnection.remoteAddr.toString()) {\n            data.value = dataRaw;\n            updateTime.value = Date.now();\n            await node.services.ha.utils.sendResponse(stream, {\n              result: true\n            });\n          } else {\n            console.log(\"skip update\");\n          }\n        }\n      );\n    } catch (error) {\n      console.log(`Error: ${error.message}`);\n      console.log(error);\n    }\n  };\n\n  const connectPeer = async peer => {\n    try {\n      const multiaddress = await checkMultiaddr(peer);\n      console.log(\"connect\", multiaddress.toString());\n      return await connect(multiaddress);\n    } catch (error) {\n      console.log(`Error: ${error.message}`);\n      console.log(error);\n    }\n    return false;\n  };\n\n  const launch = async (peerId, command) => {\n    console.log(`Launch command`, command);\n    const peer = peerId.split(\"/\");\n    const response = await request(peer[peer.length - 1], { data: command });\n    console.log(`response:`, response);\n  };\n\n  return {\n    data,\n    connectionPeerId,\n    updateTime,\n    run,\n    connectPeer,\n    launch,\n    peerId\n  };\n};\n","import { render } from \"./App.vue?vue&type=template&id=018ae7d1\"\nimport script from \"./App.vue?vue&type=script&lang=js\"\nexport * from \"./App.vue?vue&type=script&lang=js\"\n\nimport \"./App.vue?vue&type=style&index=0&id=018ae7d1&lang=css\"\n\nimport exportComponent from \"../node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['render',render]])\n\nexport default __exports__","import { createApp } from 'vue'\nimport App from './App.vue'\n\ncreateApp(App).mount('#app')\n","// The module cache\nvar __webpack_module_cache__ = {};\n\n// The require function\nfunction __webpack_require__(moduleId) {\n\t// Check if module is in cache\n\tvar cachedModule = __webpack_module_cache__[moduleId];\n\tif (cachedModule !== undefined) {\n\t\treturn cachedModule.exports;\n\t}\n\t// Create a new module (and put it into the cache)\n\tvar module = __webpack_module_cache__[moduleId] = {\n\t\t// no module.id needed\n\t\t// no module.loaded needed\n\t\texports: {}\n\t};\n\n\t// Execute the module function\n\t__webpack_modules__[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n\t// Return the exports of the module\n\treturn module.exports;\n}\n\n// expose the modules object (__webpack_modules__)\n__webpack_require__.m = __webpack_modules__;\n\n","var deferred = [];\n__webpack_require__.O = function(result, chunkIds, fn, priority) {\n\tif(chunkIds) {\n\t\tpriority = priority || 0;\n\t\tfor(var i = deferred.length; i > 0 && deferred[i - 1][2] > priority; i--) deferred[i] = deferred[i - 1];\n\t\tdeferred[i] = [chunkIds, fn, priority];\n\t\treturn;\n\t}\n\tvar notFulfilled = Infinity;\n\tfor (var i = 0; i < deferred.length; i++) {\n\t\tvar chunkIds = deferred[i][0];\n\t\tvar fn = deferred[i][1];\n\t\tvar priority = deferred[i][2];\n\t\tvar fulfilled = true;\n\t\tfor (var j = 0; j < chunkIds.length; j++) {\n\t\t\tif ((priority & 1 === 0 || notFulfilled >= priority) && Object.keys(__webpack_require__.O).every(function(key) { return __webpack_require__.O[key](chunkIds[j]); })) {\n\t\t\t\tchunkIds.splice(j--, 1);\n\t\t\t} else {\n\t\t\t\tfulfilled = false;\n\t\t\t\tif(priority < notFulfilled) notFulfilled = priority;\n\t\t\t}\n\t\t}\n\t\tif(fulfilled) {\n\t\t\tdeferred.splice(i--, 1)\n\t\t\tvar r = fn();\n\t\t\tif (r !== undefined) result = r;\n\t\t}\n\t}\n\treturn result;\n};","// getDefaultExport function for compatibility with non-harmony modules\n__webpack_require__.n = function(module) {\n\tvar getter = module && module.__esModule ?\n\t\tfunction() { return module['default']; } :\n\t\tfunction() { return module; };\n\t__webpack_require__.d(getter, { a: getter });\n\treturn getter;\n};","// define getter functions for harmony exports\n__webpack_require__.d = function(exports, definition) {\n\tfor(var key in definition) {\n\t\tif(__webpack_require__.o(definition, key) && !__webpack_require__.o(exports, key)) {\n\t\t\tObject.defineProperty(exports, key, { enumerable: true, get: definition[key] });\n\t\t}\n\t}\n};","__webpack_require__.g = (function() {\n\tif (typeof globalThis === 'object') return globalThis;\n\ttry {\n\t\treturn this || new Function('return this')();\n\t} catch (e) {\n\t\tif (typeof window === 'object') return window;\n\t}\n})();","__webpack_require__.o = function(obj, prop) { return Object.prototype.hasOwnProperty.call(obj, prop); }","// define __esModule on exports\n__webpack_require__.r = function(exports) {\n\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n\t}\n\tObject.defineProperty(exports, '__esModule', { value: true });\n};","// no baseURI\n\n// object to store loaded and loading chunks\n// undefined = chunk not loaded, null = chunk preloaded/prefetched\n// [resolve, reject, Promise] = chunk loading, 0 = chunk loaded\nvar installedChunks = {\n\t143: 0\n};\n\n// no chunk on demand loading\n\n// no prefetching\n\n// no preloaded\n\n// no HMR\n\n// no HMR manifest\n\n__webpack_require__.O.j = function(chunkId) { return installedChunks[chunkId] === 0; };\n\n// install a JSONP callback for chunk loading\nvar webpackJsonpCallback = function(parentChunkLoadingFunction, data) {\n\tvar chunkIds = data[0];\n\tvar moreModules = data[1];\n\tvar runtime = data[2];\n\t// add \"moreModules\" to the modules object,\n\t// then flag all \"chunkIds\" as loaded and fire callback\n\tvar moduleId, chunkId, i = 0;\n\tif(chunkIds.some(function(id) { return installedChunks[id] !== 0; })) {\n\t\tfor(moduleId in moreModules) {\n\t\t\tif(__webpack_require__.o(moreModules, moduleId)) {\n\t\t\t\t__webpack_require__.m[moduleId] = moreModules[moduleId];\n\t\t\t}\n\t\t}\n\t\tif(runtime) var result = runtime(__webpack_require__);\n\t}\n\tif(parentChunkLoadingFunction) parentChunkLoadingFunction(data);\n\tfor(;i < chunkIds.length; i++) {\n\t\tchunkId = chunkIds[i];\n\t\tif(__webpack_require__.o(installedChunks, chunkId) && installedChunks[chunkId]) {\n\t\t\tinstalledChunks[chunkId][0]();\n\t\t}\n\t\tinstalledChunks[chunkId] = 0;\n\t}\n\treturn __webpack_require__.O(result);\n}\n\nvar chunkLoadingGlobal = self[\"webpackChunkdapp_libp2p\"] = self[\"webpackChunkdapp_libp2p\"] || [];\nchunkLoadingGlobal.forEach(webpackJsonpCallback.bind(null, 0));\nchunkLoadingGlobal.push = webpackJsonpCallback.bind(null, chunkLoadingGlobal.push.bind(chunkLoadingGlobal));","// startup\n// Load entry module and return exports\n// This entry module depends on other loaded chunks and execution need to be delayed\nvar __webpack_exports__ = __webpack_require__.O(undefined, [998], function() { return __webpack_require__(7397); })\n__webpack_exports__ = __webpack_require__.O(__webpack_exports__);\n"],"names":["_createElementVNode","style","_createElementBlock","$setup","peerId","_hoisted_1","_hoisted_2","_toDisplayString","_hoisted_3","_hoisted_4","multiaddress","$event","type","_hoisted_5","onClick","_cache","args","connectClick","_hoisted_6","_hoisted_7","connections","length","_hoisted_8","_hoisted_9","_hoisted_10","_Fragment","_renderList","connection","k","key","connectionPeerId","_hoisted_11","_hoisted_12","_hoisted_13","launchClick","stateLamp","data","_hoisted_14","startClick","error","createHa","components","async","getRequest","stream","pipe","source","result","uint8ArrayToString","subarray","JSON","parse","console","log","sendResponse","msg","uint8ArrayFromString","stringify","sink","finally","close","handle","protocol","handler","options","runOnTransientConnection","registrar","request","status","newStream","utils","createNode","node","createLibp2p","transports","webSockets","filter","filters","circuitRelayTransport","streamMuxers","mplex","connectionEncryption","noise","services","identify","ha","connectionGater","denyDialMultiaddr","connectionManager","minConnections","pingWs","uri","Promise","res","rej","timeoutId","setTimeout","Error","ws","WebSocket","addEventListener","clearTimeout","checkMultiaddr","location","localMultiaddr","multiaddr","protoNames","check","includes","address","nodeAddress","port","start","cb","updateConnectionsList","getConnections","map","item","remoteAddr","toString","event","detail","evt","id","connect","addr","find","listenerMultiaddr","dial","remotePeer","useData","ref","updateTime","run","value","listen","protocols","getProtocols","unhandle","dataRaw","fromConnection","Date","now","message","connectPeer","peer","launch","command","split","response","setup","conns","conn","select","computed","state","lamp","undefined","device","e","__exports__","render","createApp","App","mount","__webpack_module_cache__","__webpack_require__","moduleId","cachedModule","exports","module","__webpack_modules__","call","m","deferred","O","chunkIds","fn","priority","notFulfilled","Infinity","i","fulfilled","j","Object","keys","every","splice","r","n","getter","__esModule","d","a","definition","o","defineProperty","enumerable","get","g","globalThis","this","Function","window","obj","prop","prototype","hasOwnProperty","Symbol","toStringTag","installedChunks","chunkId","webpackJsonpCallback","parentChunkLoadingFunction","moreModules","runtime","some","chunkLoadingGlobal","self","forEach","bind","push","__webpack_exports__"],"sourceRoot":""}